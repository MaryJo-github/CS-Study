# ERD와 정규화 과정
**ERD(Entity Relationship Diagram)** 
- 데이터베이스를 구축할 때 가장 기초적인 뼈대 역할
- 릴레이션 간의 관계들을 정의한 것

<br>

## 📍ERD의 중요성
- 데이터베이스를 구축의 기반이 됨
    - ERD는 시스템의 요구 사항을 기반으로 작성됨
- (데이터베이스를 구축한 이후에도) 디버깅 또는 비즈니스 프로세스 재설계가 필요한 경우에 설계도 역할을 담당
- **장점**: 관계형 구조로 표현할 수 있는 데이터를 구성하는 데 유용
- **단점**: 비정형 데이터를 충분히 표현할 수 없음
    - `비정형 데이터`: 비구조화 데이터. 미리 정의된 데이터 모델이 없거나 미리 정의된 방식으로 정리되지 않은 정보

<br>

## 📍정규화 과정
### 정규화(Normalization)란?
- 관계형 데이터베이스의 설계에서 중복을 최소화하게 데이터를 구조화하는 프로세스
- 중복된 데이터를 허용하지 않음으로써 무결성을 유지할 수 있으며, DB 저장 용량 역시 줄일 수 있다.

### 정규화 과정
- 릴레이션 간의 잘못된 종속 관계로 인한 데이터베이스 이상 현상을 해결하거나 저장 공간을 효율적으로 사용하기 위해 릴레이션을 여러 개로 분리하는 과정
    - 데이터베이스 이상 현상의 예시
        - 회원이 한 개의 등급을 가져야 하는데 세 개의 등급을 갖거나
        - 삭제할 때 필요한 데이터가 같이 삭제되고
        - 데이터를 삽입해야 하는데 하나의 필드 값이 NULL이 되면 안되어서 삽입하기 어려운 현상
- 정규형 원칙을 기반으로 정규형을 만들어 과정
- 정규화된 정도는 정규형(NF, Normal Form)으로 표현
- 기본 정규형: 제1정규형, 제2정규형, 제3정규형, 보이스/코드 정규형
- 고급 정규형: 제4정규형, 제5규형

#### 정규화의 목적
- 데이터베이스의 변경시 이상 현상 제거
- 데이터베이스 구조 확장시 재 디자인 최소화
- 사용자에게 데이터 모델을 더욱 의미있게
- 다양한 질의 지원

### 🔎 정규형 원칙
#### 제1정규형
- 릴레이션의 모든 도메인이 더 이상 분해될 수 없는 원자 값(atomic value)만으로 구성되어야함
- 릴레이션의 속성 값 중에서 한 개의 기본키에 대해 두 개 이상의 값을 가지는 반복 집합이 있어서는 안됨. 만약 반복 집합이 있다면 제거해야함

#### 제2정규형
- 제1정규형이며 부분 함수의 종속성을 제거한 형태. 완전 함수 종속을 만족하도록 테이블을 분해하는 것.
- 부분 함수의 종속성 제거란 기본키가 아닌 모든 속성이 기본키에 완전 함수 종속적인 것을 말함
    - **`완전 함수 종속`:** 기본키의 부분집합이 결정자가 되어선 안된다는 것을 의미
- 이때 주의할 점은 릴레이션을 분해할 때 동등한 릴레이션으로 분해해야 하고, 정보 손실이 발생하지 않는 무손실 분해로 분해되어야 함

#### 제3정규형
- 제2정규형이고 기본키가 아닌 모든 속성이 이행적 함수 종족(transitive FD)을 만족하지 않는 상태를 말함
    - **`이행적 함수 종속`:** 이행적 함수 종속이란 A→ B와 B→C가 존재하면 논리적으로 A→C가 성립하는데, 이 때 집합 C가 집합 A에 이행적으로 함수 종속이 되었다고 함

#### 보이스/코드 정규형(BCNF)
- 제 3정규형이고, 결정자가 후보키가 아닌 함수 종속 관계를 제거하여 릴레이션의 함수 종속 관계에서 모든 결정자가 후보키가 되도록 테이블을 분해하는 것
    - **`결정자`**: 함수 종속 관계에서 특정 종속자(dependent)를 결정 짓는 요소, ‘X→Y’일 때 X는 결정자, Y는 종속자이다.

이렇게 정규형 과정을 거쳐 테이블을 나눈다고 해서 성능이 100% 좋아지는 것은 아님. 테이블을 나누게 되면 어떠한 쿼리는 조인을 해야 하는 경우도 발생해서 오히려 느려질 수도 있기 때문에 서비스에 따라 정규화 또는 비정규화 과정을 진행해야함.
